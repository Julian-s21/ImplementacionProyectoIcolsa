@{
    var hideSidebar = (ViewData["HideSidebar"] as bool?) ?? false;

    // Recuperar el rol desde la sesi√≥n
    var userRol = Context.Session.GetString("UsuarioRol") ?? "";

    // Para controlar qu√© m√≥dulos se muestran
    bool esAdmin = userRol == "Administrativo";
    bool esSecretario = userRol == "Secretario";
    bool esEmpleado = userRol == "Empleado";
}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Panel Administrativo</title>

    <!-- BOOTSTRAP + ICONOS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />

    @RenderSection("Styles", required: false)
</head>

<body>
    <div class="container-fluid">
        <div class="row">

            @* ‚úÖ SIDEBAR *@
            @if (!hideSidebar)
            {
                <div class="col-auto p-0 sidebar-container">
                    <div class="sidebar">
                        <ul class="nav nav-pills flex-column mb-auto">
                            
                           
                            @* üì¶ PRODUCTOS (Admin, Secretario, Empleado) *@
                            @if (esAdmin || esSecretario || esEmpleado)
                            {
                                <li>
                                    <a class="nav-link @(ViewData["ActiveMenu"] as string == "Productos" ? "active" : "")" 
                                       href="@Url.Action("Index", "Producto")">
                                        <i class="bi bi-box-seam me-2"></i> Gesti√≥n de Productos
                                    </a>
                                </li>
                            }

                            @* üóÉÔ∏è INVENTARIOS (Admin, Secretario) *@
                            @if (esAdmin || esSecretario)
                            {
                                <li>
                                    <a class="nav-link @(ViewData["ActiveMenu"] as string == "Inventarios" ? "active" : "")" 
                                       href="@Url.Action("Index", "HistorialInventarioSaldo")">
                                        <i class="bi bi-archive me-2"></i> Inventarios
                                    </a>
                                </li>
                            }

                            @* üßæ PEDIDOS (Admin, Empleado) *@
                            @if (esAdmin || esEmpleado || esSecretario)
                            {
                                <li>
                                    <a class="nav-link @(ViewData["ActiveMenu"] as string == "Pedidos" ? "active" : "")" 
                                       href="@Url.Action("Index", "Pedido")">
                                        <i class="bi bi-cart-check me-2"></i> Pedidos
                                    </a>
                                </li>
                            }

                            @* üë• CLIENTES (Admin, Secretario) *@
                            @if (esAdmin || esSecretario)
                            {
                                <li>
                                    <a class="nav-link @(ViewData["ActiveMenu"] as string == "Clientes" ? "active" : "")" 
                                       href="@Url.Action("Index", "Cliente")">
                                        <i class="bi bi-people me-2"></i> Clientes
                                    </a>
                                </li>
                            }

                            @* üßë‚Äçüíª USUARIOS (solo Admin) *@
                            @if (esAdmin)
                            {
                                <li>
                                    <a class="nav-link @(ViewData["ActiveMenu"] as string == "Usuarios" ? "active" : "")" 
                                       href="@Url.Action("Index", "Usuario")">
                                        <i class="bi bi-person-gear me-2"></i> Usuarios
                                    </a>
                                </li>
                            }

                            @* üìà REPORTES (solo Admin) *@
                            @if (esAdmin)
                            {
                                <li>
                                    <a class="nav-link @(ViewData["ActiveMenu"] as string == "Reportes" ? "active" : "")" 
                                       href="@Url.Action("Index", "Reporte")">
                                        <i class="bi bi-graph-up me-2"></i> Reportes
                                    </a>
                                </li>
                            }
                        </ul>
                    </div>
                </div>
            }

            @* ‚úÖ CONTENIDO PRINCIPAL *@
            <div class="col main-content">
                <div class="header d-flex justify-content-between align-items-center">
                    <div>
                        <h2 class="m-0">@ViewData["Title"]</h2>
                        <small class="text-muted">Rol: @userRol</small>
                    </div>

                    <a href="@Url.Action("Logout", "Usuario")" class="btn btn-outline-danger btn-sm">
                        <i class="bi bi-box-arrow-right"></i> Cerrar Sesi√≥n
                    </a>
                </div>

                @RenderBody()
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    @RenderSection("Scripts", required: false)
</body>
</html>
